"use strict";(self.webpackChunkcosmos_sdk_docs=self.webpackChunkcosmos_sdk_docs||[]).push([[54365],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>h});var i=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},s=Object.keys(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=i.createContext({}),c=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},u=function(e){var t=c(e.components);return i.createElement(l.Provider,{value:t},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},p=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,s=e.originalType,l=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),d=c(n),p=a,h=d["".concat(l,".").concat(p)]||d[p]||m[p]||s;return n?i.createElement(h,r(r({ref:t},u),{},{components:n})):i.createElement(h,r({ref:t},u))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var s=n.length,r=new Array(s);r[0]=p;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o[d]="string"==typeof e?e:a,r[1]=o;for(var c=2;c<s;c++)r[c]=n[c];return i.createElement.apply(null,r)}return i.createElement.apply(null,n)}p.displayName="MDXCreateElement"},86672:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>m,frontMatter:()=>s,metadata:()=>o,toc:()=>c});var i=n(87462),a=(n(67294),n(3905));const s={sidebar_position:1},r="Guide to Multisig transactions",o={unversionedId:"user/run-node/multisig-guide",id:"version-0.47/user/run-node/multisig-guide",title:"Guide to Multisig transactions",description:"Overview",source:"@site/versioned_docs/version-0.47/user/run-node/07-multisig-guide.md",sourceDirName:"user/run-node",slug:"/user/run-node/multisig-guide",permalink:"/v0.47/user/run-node/multisig-guide",draft:!1,tags:[],version:"0.47",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"userSidebar",previous:{title:"Running in Production",permalink:"/v0.47/user/run-node/run-production"}},l={},c=[{value:"Overview",id:"overview",level:2},{value:"Step by step guide to multisig transactions",id:"step-by-step-guide-to-multisig-transactions",level:2}],u={toc:c},d="wrapper";function m(e){let{components:t,...n}=e;return(0,a.kt)(d,(0,i.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"guide-to-multisig-transactions"},"Guide to Multisig transactions"),(0,a.kt)("h2",{id:"overview"},"Overview"),(0,a.kt)("p",null,"Multisignature accounts are accounts that are generated from multiple public keys. A multisig necessitates that any transaction made on its behalf must be signed by a specified threshold of its members."),(0,a.kt)("p",null,"A common use case for multisigs is to increase security of a signing account, and/or enable multiple parties to agree on and authorize a transaction."),(0,a.kt)("p",null,"The first step is to create a multisig signing key by using the public keys of all possible signers and the minimum threshold of addresses that are needed to sign any transaction from the account. The threshold can be the same amount as the total number of addresses comprising the multisig."),(0,a.kt)("p",null,"Whatever machine is generating the multisig, it should at least have all of the public keys imported into the same keyring."),(0,a.kt)("p",null,"When you want to create a multisig transaction, you would create the transaction as normal, but instead of signing it with a single account's private key, you would need to sign it with the private keys of the accounts that make up the multisig key."),(0,a.kt)("p",null,"This is done by signing the transaction multiple times, once with each private key. The order of the signatures matters and must match the order of the public keys in the multisig key."),(0,a.kt)("p",null,"Once you have a transaction with the necessary signatures, it can be broadcasted to the network. The network will verify that the transaction has the necessary signatures from the accounts in the multisig key before it is executed."),(0,a.kt)("h2",{id:"step-by-step-guide-to-multisig-transactions"},"Step by step guide to multisig transactions"),(0,a.kt)("p",null,"This tutorial will use the test keyring which will store the keys in the default home directory ",(0,a.kt)("inlineCode",{parentName:"p"},"~/.simapp")," unless otherwise specified.\nVerify which keys are available in the test keyring by running ",(0,a.kt)("inlineCode",{parentName:"p"},"--keyring-backend test"),"."),(0,a.kt)("p",null,"In order to specify a consistent keyring for the entirety of the tutorial, set the default keyring by running ",(0,a.kt)("inlineCode",{parentName:"p"},"simd config keyring-backend test"),"."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"simd keys list\n")),(0,a.kt)("p",null,"If you don't already have accounts listed create the accounts using the below."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"simd keys add alice\nsimd keys add bob\nsimd keys add recipient\n")),(0,a.kt)("p",null,"Alternatively the public keys comprising the multisig can be imported into the keyring."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"simd keys add alice --pubkey <public key> --keyring backend test\n")),(0,a.kt)("p",null,"Create the multisig account between bob and alice."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"simd keys add alice-bob-multisig --multisig alice,bob --multisig-threshold 2\n")),(0,a.kt)("p",null,"Before generating any transaction, verify the balance of each account and note the amount. This step is crucial to confirm that the transaction can be processed successfully."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"simd query bank balances $(simd keys show my_validator -a)\nsimd query bank balances $(simd keys show alice-bob-multisig -a)\n")),(0,a.kt)("p",null,"Ensure that the alice-bob-multisig account is funded with a sufficient balance to complete the transaction (gas included). In our case, the genesis account, my_validator, holds our funds. Therefore, we will transfer funds from the ",(0,a.kt)("inlineCode",{parentName:"p"},"my_validator")," account to the ",(0,a.kt)("inlineCode",{parentName:"p"},"alice-bob-multisig")," account.\nFund the multisig by sending it ",(0,a.kt)("inlineCode",{parentName:"p"},"stake")," from the genesis account."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},' simd tx bank send $(simd keys show my_validator -a) $(simd keys show alice-bob-multisig -a) "10000stake"\n')),(0,a.kt)("p",null,"Check both accounts again to see if the funds have transferred."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"simd query bank balances $(simd keys show alice-bob-multisig -a)\n")),(0,a.kt)("p",null,"Initiate the transaction. This command will create a transaction from the multisignature account ",(0,a.kt)("inlineCode",{parentName:"p"},"alice-bob-multisig")," to send 1000stake to the recipient account. The transaction will be generated but not broadcasted yet."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"simd tx bank send $(simd keys show alice-bob-multisig -a) $(simd keys show recipient -a) 1000stake --generate-only --chain-id my-test-chain > tx.json\n")),(0,a.kt)("p",null,"Alice signs the transaction using their key and refers to the multisig address. Execute the command below to accomplish this:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"simd tx sign --from $(simd keys show alice -a) --multisig=cosmos1re6mg24kvzjzmwmly3dqrqzdkruxwvctw8wwds tx.json --chain-id my-test-chain > tx-signed-alice.json\n")),(0,a.kt)("p",null,"Let's repeat for Bob."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"simd tx sign --from $(simd keys show bob -a) --multisig=cosmos1re6mg24kvzjzmwmly3dqrqzdkruxwvctw8wwds tx.json --chain-id my-test-chain > tx-signed-bob.json\n")),(0,a.kt)("p",null,"Execute a multisign transaction by using the ",(0,a.kt)("inlineCode",{parentName:"p"},"simd tx multisign")," command. This command requires the names and signed transactions of all the participants in the multisig account. Here, Alice and Bob are the participants:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"simd tx multisign tx.json alice-bob-multisig tx-signed-alice.json tx-signed-bob.json --chain-id my-test-chain > tx-signed.json\n")),(0,a.kt)("p",null,"Once the multisigned transaction is generated, it needs to be broadcasted to the network. This is done using the simd tx broadcast command:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"simd tx broadcast tx-signed.json --chain-id my-test-chain --gas auto --fees 250stake\n")),(0,a.kt)("p",null,"Once the transaction is broadcasted, it's a good practice to verify if the transaction was successful. You can query the recipient's account balance again to confirm if the funds were indeed transferred:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"simd query bank balances $(simd keys show alice-bob-multisig -a)\n")))}m.isMDXComponent=!0}}]);